var Location=function(o,e,a,t,n,i,s,l){this.id=o,this.name=e,this.lat=a,this.lng=t,this.address=n,this.description=i,this.category=s,this.imgs=l};Location.prototype.openInfo=function(){googleMap.showInfo(this.id)};var LocationsMV=function(){var o=this;o.allLocations=ko.observableArray([]),o.locations=ko.observableArray([]),o.searchPhrase=ko.observable(""),localStorage.locations||(localStorage.locations=JSON.stringify([]));var e="https://api.foursquare.com/v2/venues/explore?",a="client_id=SATQVTWJMMSVYMQXT5F2DHYONKZEAH42NFYLOQEGPKSU4MTZ&client_secret=GCO1VDDV2GJGEGS4DAWSCXQIOMRGGCQIL4CMQOUKJFUMWFX2&v=20160323",t="&near=santa%20monica&query=surfing",n="https://api.foursquare.com/v2/venues/";$.getJSON(e+a+t).done(function(e){var t=e.response.groups[0].items;_.each(t,function(e){var t=e.venue,i=t.name,s=t.location.lat,l=t.location.lng,r=t.location.formattedAddress[0],c=e.tips[0].text,g=t.categories[0].name,p=new Location(t.id,i,s,l,r,c,g);o.allLocations.push(p),o.locations.push(p),$.getJSON(n+t.id+"/photos?"+a+"&limit=6").done(function(e){var a=e.response.photos;o.allLocations().find(function(o){return o.id===t.id}).imgs=a,googleMap.addPhotos(t.id,a),localStorage.locations=JSON.stringify(o.allLocations())})}),localStorage.locations=JSON.stringify(o.allLocations()),o.allLocations().forEach(googleMap.addMarker)}).fail(function(){$("header").append("<div class='alert alert-warning col-md-12' role='alert'>Error, couldn't connect to Foursquare API. Results may not be up to date.</div>"),o.allLocations(JSON.parse(localStorage.locations)),o.allLocations().forEach(googleMap.addMarker),o.locations=ko.observableArray(o.allLocations())}),o.searchLocations=function(e){var a=_.filter(o.allLocations(),function(e){var a=o.searchPhrase().toLowerCase();return e.name.toLowerCase().includes(a)||e.description.toLowerCase().includes(a)});o.locations(a),googleMap.setLocations(_.pluck(a,"id"))},o.clearSearch=function(){o.searchPhrase(""),o.locations(o.allLocations()),googleMap.showAllMarkers()}};$(document).ready(function(){ko.applyBindings(new LocationsMV)});var googleMap={map:null,gmapRequestTimeout:null,markers:{},infowindows:{},initMap:function(){googleMap.map=new google.maps.Map(document.getElementById("map"),{center:{lat:34.01945,lng:-118.49119},zoom:12}),clearTimeout(googleMap.gmapRequestTimeout),$(document).trigger("maploaded")},addMarker:function(o){if(googleMap.map){var e,a="<div class='text-center'><h4>"+o.name+"</h4><p>"+o.description+"</p></div>",t=new google.maps.InfoWindow({content:a}),n={lat:Number(o.lat),lng:Number(o.lng)};switch(o.category){case"Beach":e="http://maps.google.com/mapfiles/ms/icons/blue-dot.png";break;case"Resort":e="http://maps.google.com/mapfiles/ms/icons/green-dot.png";break;case"Caf√©":e="http://maps.google.com/mapfiles/ms/icons/yellow-dot.png";break;default:e="http://maps.google.com/mapfiles/ms/icons/red-dot.png"}var i=new google.maps.Marker({icon:e,position:n,title:"Hello World!"});i.addListener("click",function(){i.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){i.setAnimation(null)},1400),t.open(googleMap.map,i)}),i.setMap(googleMap.map),googleMap.markers[o.id]=i,googleMap.infowindows[o.id]=t,$(document).trigger("markerload"+o.id)}else $(document).bind("maploaded",function(){googleMap.addMarker(o)})},setLocations:function(o){_.each(googleMap.markers,function(o){o.setMap(null)}),o.forEach(function(o){googleMap.markers[o].setMap(googleMap.map)})},showAllMarkers:function(){_.each(googleMap.markers,function(o){o.setMap(googleMap.map)})},addPhotos:function(o,e){if(googleMap.markers[o]){var a=$.parseHTML(googleMap.infowindows[o].getContent());_.each(e.items,function(o){$(a).append('<img src ="'+o.prefix+"200x100"+o.suffix+'">')}),googleMap.infowindows[o].setContent($(a).prop("outerHTML"))}else $(document).bind("markerload"+o,function(){googleMap.addPhotos(o,e)})},showInfo:function(o){google.maps.event.trigger(googleMap.markers[o],"click")}};$(document).ready(function(){googleMap.gmapRequestTimeout=setTimeout(function(){$("#map").text("Failed to get Google Map. Please check your connection.")},8e3)}),$(document).ready(function(){$('[data-toggle="offcanvas"]').click(function(){$(".row-offcanvas").toggleClass("active")})});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC1tb2RlbFZpZXcuanMiLCJtYXAuanMiLCJzdHlsZS5qcyJdLCJuYW1lcyI6WyJMb2NhdGlvbiIsImlkIiwibmFtZSIsImxhdCIsImxuZyIsImFkZHJlc3MiLCJkZXNjcmlwdGlvbiIsImNhdGVnb3J5IiwiaW1ncyIsInRoaXMiLCJwcm90b3R5cGUiLCJvcGVuSW5mbyIsImdvb2dsZU1hcCIsInNob3dJbmZvIiwiTG9jYXRpb25zTVYiLCJzZWxmIiwiYWxsTG9jYXRpb25zIiwia28iLCJvYnNlcnZhYmxlQXJyYXkiLCJsb2NhdGlvbnMiLCJzZWFyY2hQaHJhc2UiLCJvYnNlcnZhYmxlIiwibG9jYWxTdG9yYWdlIiwiSlNPTiIsInN0cmluZ2lmeSIsImZvdXJzcXVhcmVVUkwiLCJjbGllbnRpZCIsImV4cGxvcmVQYXJhbXMiLCJwaWN0dXJlVVJMIiwiJCIsImdldEpTT04iLCJkb25lIiwiZGF0YSIsIml0ZW1zIiwicmVzcG9uc2UiLCJncm91cHMiLCJfIiwiZWFjaCIsIml0ZW0iLCJ2ZW51ZSIsImxvY2F0aW9uIiwiZm9ybWF0dGVkQWRkcmVzcyIsInRpcHMiLCJ0ZXh0IiwiY2F0ZWdvcmllcyIsImxvYyIsInB1c2giLCJwaG90b3MiLCJmaW5kIiwibCIsImFkZFBob3RvcyIsImZvckVhY2giLCJhZGRNYXJrZXIiLCJmYWlsIiwiYXBwZW5kIiwicGFyc2UiLCJzZWFyY2hMb2NhdGlvbnMiLCJmb3JtIiwiZmlsdGVyZWQiLCJmaWx0ZXIiLCJsb3dlciIsInRvTG93ZXJDYXNlIiwiaW5jbHVkZXMiLCJzZXRMb2NhdGlvbnMiLCJwbHVjayIsImNsZWFyU2VhcmNoIiwic2hvd0FsbE1hcmtlcnMiLCJkb2N1bWVudCIsInJlYWR5IiwiYXBwbHlCaW5kaW5ncyIsIm1hcCIsImdtYXBSZXF1ZXN0VGltZW91dCIsIm1hcmtlcnMiLCJpbmZvd2luZG93cyIsImluaXRNYXAiLCJnb29nbGUiLCJtYXBzIiwiTWFwIiwiZ2V0RWxlbWVudEJ5SWQiLCJjZW50ZXIiLCJ6b29tIiwiY2xlYXJUaW1lb3V0IiwidHJpZ2dlciIsImljb24iLCJpbmZvIiwiaW5mb3dpbmRvdyIsIkluZm9XaW5kb3ciLCJjb250ZW50IiwibXlMYXRsbmciLCJOdW1iZXIiLCJtYXJrZXIiLCJNYXJrZXIiLCJwb3NpdGlvbiIsInRpdGxlIiwiYWRkTGlzdGVuZXIiLCJzZXRBbmltYXRpb24iLCJBbmltYXRpb24iLCJCT1VOQ0UiLCJzZXRUaW1lb3V0Iiwib3BlbiIsInNldE1hcCIsImJpbmQiLCJpZHMiLCJpIiwicGFyc2VIVE1MIiwiZ2V0Q29udGVudCIsInBob3RvIiwicHJlZml4Iiwic3VmZml4Iiwic2V0Q29udGVudCIsInByb3AiLCJldmVudCIsImNsaWNrIiwidG9nZ2xlQ2xhc3MiXSwibWFwcGluZ3MiOiJBQVdBLEdBQUFBLFVBQUEsU0FBQUMsRUFBQUMsRUFBQUMsRUFBQUMsRUFBQUMsRUFBQUMsRUFBQUMsRUFBQUMsR0FDQUMsS0FBQVIsR0FBQUEsRUFDQVEsS0FBQVAsS0FBQUEsRUFDQU8sS0FBQU4sSUFBQUEsRUFDQU0sS0FBQUwsSUFBQUEsRUFDQUssS0FBQUosUUFBQUEsRUFDQUksS0FBQUgsWUFBQUEsRUFDQUcsS0FBQUYsU0FBQUEsRUFDQUUsS0FBQUQsS0FBQUEsRUFLQVIsVUFBQVUsVUFBQUMsU0FBQSxXQUNBQyxVQUFBQyxTQUFBSixLQUFBUixJQVFBLElBQUFhLGFBQUEsV0FFQSxHQUFBQyxHQUFBTixJQUNBTSxHQUFBQyxhQUFBQyxHQUFBQyxvQkFDQUgsRUFBQUksVUFBQUYsR0FBQUMsb0JBQ0FILEVBQUFLLGFBQUFILEdBQUFJLFdBQUEsSUFFQUMsYUFBQUgsWUFDQUcsYUFBQUgsVUFBQUksS0FBQUMsY0FHQSxJQUFBQyxHQUFBLGdEQUNBQyxFQUFBLHVJQUNBQyxFQUFBLHFDQUNBQyxFQUFBLHVDQUdBQyxHQUFBQyxRQUFBTCxFQUFBQyxFQUFBQyxHQUFBSSxLQUFBLFNBQUFDLEdBQ0EsR0FBQUMsR0FBQUQsRUFBQUUsU0FBQUMsT0FBQSxHQUFBRixLQUNBRyxHQUFB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QSxXQUVBeEQsVUFBQTJELG1CQUFBMkIsV0FBQSxXQUNBckUsRUFBQSxRQUFBYyxLQUFBLDREQUNBLE9DaElBZCxFQUFBc0MsVUFBQUMsTUFBQSxXQUNBdkMsRUFBQSw2QkFBQW1GLE1BQUEsV0FDQW5GLEVBQUEsa0JBQUFvRixZQUFBIiwiZmlsZSI6Im1haW4ubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqIEBjb25zdHJ1Y3RvclxuICogIEBkZXNjcmlwdGlvbiByZXByZXNlbnRzIGEgbG9jYXRpb24gYW5kIGFzc29jaWF0ZWQgZGF0YSwgYXMgcmV0dXJuZWQgYnkgZm91cnNxdWFyZSBBUElcbiAqXHRAcHJvcGVydHkge3N0cmluZ30gaWQgLSBGb3Vyc3F1YXJlIHZlbnVlIGlkLiBUaGlzIGlzIHVuaXF1ZS5cbiAqICBAcHJvcGVydHkge3N0cmluZ30gbmFtZSAtIExvY2F0aW9uIG5hbWUsIHB1bGxlZCBmcm9tIEZvdXJzcXVhcmUuXG4gKiAgQHByb3BlcnR5IHtudW1iZXJ9IGxhdCAtIExhdGl0dWRlIG9mIGxvY2F0aW9uXG4gKiAgQHByb3BlcnR5IHtudW1iZXJ9IGxuZyAtIExvbmdpdHVkZSBvZiBsb2NhdGlvblxuICogIEBwcm9wZXJ0eSB7c3RyaW5nfSBhZGRyZXNzIC0gQWRkcmVzcyBvZiBsb2NhdGlvblxuICogIEBwcm9wZXJ0eSB7c3RyaW5nfSBkZXNjcmlwdGlvbiAtIERlc2NyaXB0aW9uIG9mIGxvY2F0aW9uXG4gKiAgQHByb3BlcnR5IHtzdHJpbmd9IGNhdGVnb3J5IC0gQ2F0ZWdvcnkgb2YgbG9jYXRpb24gcGVyIEZvdXJzcXVhcmUuIFVzZWQgdG8gY2hvb3NlIG1hcCBtYXJrZXJcbiAqICBAcHJvcGVydHkge2FycmF5fSBpbWdzIC0gQXJyYXkgb2YgaW1hZ2VzLCBpbiBmb3JtYXQgcmV0dXJuZWQgYnkgRm91cnNxdWFyZVxuICovXG52YXIgTG9jYXRpb24gPSBmdW5jdGlvbihpZCwgbmFtZSwgbGF0LCBsbmcsIGFkZHJlc3MsIGRlc2NyaXB0aW9uLCBjYXRlZ29yeSwgaW1ncyl7XG5cdHRoaXMuaWQgPSBpZC8vXy51bmlxdWVJZCgpOyBub3cgdXNpbmcgZm91cnNxdWFyZSB2ZW51ZSBpZHNcblx0dGhpcy5uYW1lID0gbmFtZTtcblx0dGhpcy5sYXQgPSBsYXQ7XG5cdHRoaXMubG5nID0gbG5nO1xuXHR0aGlzLmFkZHJlc3MgPSBhZGRyZXNzO1xuXHR0aGlzLmRlc2NyaXB0aW9uID0gZGVzY3JpcHRpb247XG5cdHRoaXMuY2F0ZWdvcnkgPSBjYXRlZ29yeTtcblx0dGhpcy5pbWdzID0gaW1nczsgLy8gYXJyYXkgaGVyZVxufTtcblxuLyoqIEBtZXRob2QgT3BlbnMgdGhlIGdvb2dsZSBtYXBzIGluZm9XaW5kb3cgYXNzb2NpYXRlZCB3aXRoIHRoZSBsaXN0LlxuICovXG5Mb2NhdGlvbi5wcm90b3R5cGUub3BlbkluZm8gPSBmdW5jdGlvbigpe1xuXHRcdGdvb2dsZU1hcC5zaG93SW5mbyh0aGlzLmlkKTtcblx0fVxuXG4vKiogQGRlc2NyaXB0aW9uIEtPIE1vZGVsVmlldyBjb250cm9sbGluZyBhbGwgbm9uLW1hcCBmdW5jdGlvbnNcbiAqXHRAcHJvcGVydHkge2FycmF5fSBhbGxMb2NhdGlvbnMgLSBjb250YWlucyBhbGwgbG9jYXRpb25zIHJldHVybmVkIGJ5IGZvdXJzcXVhcmVcbiAqXHRAcHJvcGVydHkge2FycmF5fSBsb2NhdGlvbnMgLSBjb250YWlucyBhbGwgbG9jYXRpb25zIGN1cnJlbnRseSBkaXNwbGF5ZWQgb24gbWFwL2xpc3QgKGFmdGVyIGZpbHRlciBpcyBhcHBsaWVkKVxuICpcdEBwcm9wZXJ0eSB7c3RyaW5nfSBzZWFyY2hQaHJhc2UgLSBzdHJpbmcgdG8gZmlsdGVyIHRocm91Z2ggbmFtZXMvZGVzY3JpcHRpb25zLlxuICovXG52YXIgTG9jYXRpb25zTVYgPSBmdW5jdGlvbigpe1xuXHRcblx0dmFyIHNlbGYgPSB0aGlzO1xuXHRzZWxmLmFsbExvY2F0aW9ucyA9IGtvLm9ic2VydmFibGVBcnJheShbXSk7XG5cdHNlbGYubG9jYXRpb25zID0ga28ub2JzZXJ2YWJsZUFycmF5KFtdKTtcblx0c2VsZi5zZWFyY2hQaHJhc2UgPSBrby5vYnNlcnZhYmxlKCcnKTtcblxuXHRpZighbG9jYWxTdG9yYWdlLmxvY2F0aW9ucykge1xuXHRcdGxvY2FsU3RvcmFnZS5sb2NhdGlvbnMgPSBKU09OLnN0cmluZ2lmeShbXSk7XG5cdH1cblxuXHR2YXIgZm91cnNxdWFyZVVSTCA9IFwiaHR0cHM6Ly9hcGkuZm91cnNxdWFyZS5jb20vdjIvdmVudWVzL2V4cGxvcmU/XCI7XG5cdHZhciBjbGllbnRpZCA9IFwiY2xpZW50X2lkPVNBVFFWVFdKTU1TVllNUVhUNUYyREhZT05LWkVBSDQyTkZZTE9RRUdQS1NVNE1UWiZjbGllbnRfc2VjcmV0PUdDTzFWRERWMkdKR0VHUzREQVdTQ1hRSU9NUkdHQ1FJTDRDTVFPVUtKRlVNV0ZYMiZ2PTIwMTYwMzIzXCI7XG5cdHZhciBleHBsb3JlUGFyYW1zID1cIiZuZWFyPXNhbnRhJTIwbW9uaWNhJnF1ZXJ5PXN1cmZpbmdcIjtcblx0dmFyIHBpY3R1cmVVUkwgPSBcImh0dHBzOi8vYXBpLmZvdXJzcXVhcmUuY29tL3YyL3ZlbnVlcy9cIjtcblxuXHQvL3VzZSBmb3Vyc3F1YXJlIGV4cGxvcmUgQVBJIHRvIGZpbmQgc3VyZiBzaXRlcyBuZWFyIFNhbnRhIE1vbmljYVxuXHQkLmdldEpTT04oZm91cnNxdWFyZVVSTCtjbGllbnRpZCtleHBsb3JlUGFyYW1zKS5kb25lKGZ1bmN0aW9uKGRhdGEpe1xuXHRcdHZhciBpdGVtcyA9IGRhdGEucmVzcG9uc2UuZ3JvdXBzWzBdLml0ZW1zO1xuXHRcdF8uZWFjaChpdGVtcywgZnVuY3Rpb24oaXRlbSl7XG5cdFx0XHR2YXIgdmVudWUgPSBpdGVtLnZlbnVlO1xuXHRcdFx0dmFyIG5hbWUgPSB2ZW51ZS5uYW1lO1xuXHRcdFx0dmFyIGxhdCA9IHZlbnVlLmxvY2F0aW9uLmxhdDtcblx0XHRcdHZhciBsbmcgPSB2ZW51ZS5sb2NhdGlvbi5sbmc7XG5cdFx0XHR2YXIgYWRkcmVzcyA9IHZlbnVlLmxvY2F0aW9uLmZvcm1hdHRlZEFkZHJlc3NbMF07XG5cdFx0XHR2YXIgZGVzY3JpcHRpb24gPSBpdGVtLnRpcHNbMF0udGV4dDtcblx0XHRcdHZhciBjYXRlZ29yeSA9IHZlbnVlLmNhdGVnb3JpZXNbMF0ubmFtZTtcblx0XHRcdHZhciBsb2MgPSBuZXcgTG9jYXRpb24odmVudWUuaWQsIG5hbWUsIGxhdCwgbG5nLCBhZGRyZXNzLCBkZXNjcmlwdGlvbiwgY2F0ZWdvcnkpO1xuXHRcdFx0c2VsZi5hbGxMb2NhdGlvbnMucHVzaChsb2MpO1xuXHRcdFx0c2VsZi5sb2NhdGlvbnMucHVzaChsb2MpO1xuXG5cdFx0XHQvL2xvYWQgcGljdHVyZXMgaW4gYmFja2dyb3VuZCAtLSBpZiB0aGlzIGZhaWxzLCBkb24ndCBhZGQgcGhvdG9zXG5cdFx0XHQkLmdldEpTT04ocGljdHVyZVVSTCt2ZW51ZS5pZCtcIi9waG90b3M/XCIrY2xpZW50aWQrXCImbGltaXQ9NlwiKS5kb25lKGZ1bmN0aW9uKGRhdGEpe1xuXHRcdFx0XHR2YXIgcGhvdG9zID0gZGF0YS5yZXNwb25zZS5waG90b3M7XG5cdFx0XHRcdHNlbGYuYWxsTG9jYXRpb25zKCkuZmluZChmdW5jdGlvbihsKXtcblx0XHRcdFx0XHRyZXR1cm4gbC5pZCA9PT0gdmVudWUuaWQ7XG5cdFx0XHRcdH0pLmltZ3MgPSBwaG90b3M7XG5cblx0XHRcdFx0Ly9zaG93IHBob3RvcyBpbiBpbmZvd2luZG93XG5cdFx0XHRcdGdvb2dsZU1hcC5hZGRQaG90b3ModmVudWUuaWQsIHBob3Rvcyk7XG5cblx0XHRcdFx0bG9jYWxTdG9yYWdlLmxvY2F0aW9ucyA9IEpTT04uc3RyaW5naWZ5KHNlbGYuYWxsTG9jYXRpb25zKCkpO1xuXHRcdFx0fSk7XG5cdFx0fSk7XG5cdFx0bG9jYWxTdG9yYWdlLmxvY2F0aW9ucyA9IEpTT04uc3RyaW5naWZ5KHNlbGYuYWxsTG9jYXRpb25zKCkpO1xuXHRcdHNlbGYuYWxsTG9jYXRpb25zKCkuZm9yRWFjaChnb29nbGVNYXAuYWRkTWFya2VyKTtcblx0fSlcblx0LmZhaWwoZnVuY3Rpb24oKSB7XG5cdFx0JCgnaGVhZGVyJykuYXBwZW5kKFwiPGRpdiBjbGFzcz0nYWxlcnQgYWxlcnQtd2FybmluZyBjb2wtbWQtMTInIHJvbGU9J2FsZXJ0Jz5FcnJvciwgY291bGRuJ3QgY29ubmVjdCB0byBGb3Vyc3F1YXJlIEFQSS4gUmVzdWx0cyBtYXkgbm90IGJlIHVwIHRvIGRhdGUuPC9kaXY+XCIpO1xuXHRcdHNlbGYuYWxsTG9jYXRpb25zKEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmxvY2F0aW9ucykpO1xuXHRcdHNlbGYuYWxsTG9jYXRpb25zKCkuZm9yRWFjaChnb29nbGVNYXAuYWRkTWFya2VyKTtcblx0XHRzZWxmLmxvY2F0aW9ucyA9IGtvLm9ic2VydmFibGVBcnJheShzZWxmLmFsbExvY2F0aW9ucygpKTtcblx0fSk7XG5cblx0LyoqIEBtZXRob2QgRmlsdGVyIHRocm91Z2ggYWxsIGxvY2F0aW9ucyBzbyBvbmx5IHRob3NlIHdpdGggbmFtZS9kZXNjcmlwdGlvbiBhcHBlYXIuIFxuXHQgKi9cblx0c2VsZi5zZWFyY2hMb2NhdGlvbnMgPSBmdW5jdGlvbihmb3JtKXtcblx0XHR2YXIgZmlsdGVyZWQgPSBfLmZpbHRlcihzZWxmLmFsbExvY2F0aW9ucygpLCBmdW5jdGlvbihsb2Mpe1xuXHRcdFx0dmFyIGxvd2VyID0gc2VsZi5zZWFyY2hQaHJhc2UoKS50b0xvd2VyQ2FzZSgpO1xuXHRcdFx0cmV0dXJuIGxvYy5uYW1lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMobG93ZXIpIHx8IGxvYy5kZXNjcmlwdGlvbi50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKGxvd2VyKTtcblx0XHR9KTtcblx0XHRzZWxmLmxvY2F0aW9ucyhmaWx0ZXJlZCk7XG5cdFx0Z29vZ2xlTWFwLnNldExvY2F0aW9ucyhfLnBsdWNrKGZpbHRlcmVkLCdpZCcpKTtcblx0fTtcblxuXHQvKiogQG1ldGhvZCBDbGVhciB0aGUgc2VhcmNoIGJhciwgc2hvdyBhbGwgbG9jYXRpb25zIGFnYWluLlxuXHQgKi9cblx0c2VsZi5jbGVhclNlYXJjaCA9IGZ1bmN0aW9uKCl7XG5cdFx0c2VsZi5zZWFyY2hQaHJhc2UoJycpO1xuXHRcdHNlbGYubG9jYXRpb25zKHNlbGYuYWxsTG9jYXRpb25zKCkpO1xuXHRcdGdvb2dsZU1hcC5zaG93QWxsTWFya2VycygpO1xuXHR9XG5cbn07XG5cbiQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uKCl7XG5cdGtvLmFwcGx5QmluZGluZ3MobmV3IExvY2F0aW9uc01WKCkpO1xufSk7IiwiLyoqIEBkZXNjcmlwdGlvbiBPYmplY3QgdG8gY29udGFpbiBhbGwgZ29vZ2xlbWFwIHZhcmlhYmxlcy9tZXRob2RzXG4gKiAgQHByb3BlcnR5IHtvYmplY3R9IG1hcCAtIGNvbnRhaW5zIHRoZSBNYXAgb2JqZWN0IGZyb20gZ29vZ2xlIG1hcHMgQVBJXG4gKiAgQHByb3BlcnR5IHt0aW1lb3V0fSBnbWFwUmVxdWVzdFRpbWVvdXQgLSB1c2VkIHRvIHRyYWNrIGlmIHRoZSBtYXAgaGFzIGxvYWRlZCBvciBub3RcbiAqICBAcHJvcGVydHkge2FycmF5fSBtYXJrZXJzIC0gY29udGFpbnMgYWxsIG1hcmtlcnMgb24gdGhlIG1hcCwgaW5kZXhlZCBieSB0aGVpciBsb2NhdGlvbiBpZFxuICogIEBwcm9wZXJ0eSB7YXJyYXl9IGluZm93aW5kb3dzIC0gY29udGFpbnMgYWxsIGluZm93aW5kb3dzIG9uIHRoZSBtYXAsIGluZGV4ZWQgYnkgdGhlaXIgbG9jYXRpb24gaWRcbiAqL1xudmFyIGdvb2dsZU1hcCA9IHtcblx0bWFwOiBudWxsLFxuXHRnbWFwUmVxdWVzdFRpbWVvdXQ6IG51bGwsXG5cdG1hcmtlcnM6IHt9LFxuXHRpbmZvd2luZG93czoge30sXG5cblx0LyoqIEBtZXRob2QgaW5pdGlhbGl6ZXMgdGhlIG1hcCwgY2VudGVyZWQgYXJvdW5kIFNhbnRhIE1vbmljYS5cblx0ICogIEZpcmVzIGEgbWFwbG9hZGVkIGV2ZW50IHdoZW4gZG9uZS5cblx0ICovXG5cdGluaXRNYXA6IGZ1bmN0aW9uKCkge1xuXHRcdGdvb2dsZU1hcC5tYXAgPSBuZXcgZ29vZ2xlLm1hcHMuTWFwKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYXAnKSwge1xuXHRcdCAgY2VudGVyOiB7bGF0OiAzNC4wMTk0NSwgbG5nOiAtMTE4LjQ5MTE5fSxcblx0XHQgIHpvb206IDEyXG5cdFx0fSk7XG5cdFx0Y2xlYXJUaW1lb3V0KGdvb2dsZU1hcC5nbWFwUmVxdWVzdFRpbWVvdXQpO1xuXHRcdCQoZG9jdW1lbnQpLnRyaWdnZXIoXCJtYXBsb2FkZWRcIik7XG5cdH0sXG5cblx0LyoqIEBtZXRob2QgYWRkcyBhIG1hcmtlciB0byB0aGUgbWFwLCB1c2luZyBsb2NhdGlvbiBpbmZvXG5cdCAqICBGaXJlcyBhIG1hcmtlcmxvYWQgZXZlbnQgd2hlbiBkb25lLlxuXHQgKi9cblx0YWRkTWFya2VyOiBmdW5jdGlvbiAobG9jKSB7XG5cdFx0aWYoIWdvb2dsZU1hcC5tYXApey8vd2FpdCBmb3IgbWFwIHRvIGJlIGluaXRpYWxpemVkIHByaW9yIHRvIGFkZGluZyBtYXJrZXIuXG5cdFx0XHQkKGRvY3VtZW50KS5iaW5kKFwibWFwbG9hZGVkXCIsZnVuY3Rpb24oKXtcblx0XHRcdFx0Z29vZ2xlTWFwLmFkZE1hcmtlcihsb2MpO1xuXHRcdFx0fSk7XG5cdFx0fVxuXHRcdGVsc2Uge1xuXHRcdFx0dmFyIGluZm8gPSBcIjxkaXYgY2xhc3M9J3RleHQtY2VudGVyJz48aDQ+XCIrbG9jLm5hbWUrXCI8L2g0PjxwPlwiK2xvYy5kZXNjcmlwdGlvbitcIjwvcD48L2Rpdj5cIjtcblx0XHRcdHZhciBpbmZvd2luZG93ID0gbmV3IGdvb2dsZS5tYXBzLkluZm9XaW5kb3coe1xuXHRcdFx0ICAgIGNvbnRlbnQ6IGluZm9cblx0XHRcdCAgfSk7XG5cdFx0XHR2YXIgbXlMYXRsbmcgPSB7bGF0Ok51bWJlcihsb2MubGF0KSwgbG5nOiBOdW1iZXIobG9jLmxuZyl9O1xuXG5cdFx0XHQvLyB1c2VkIGRpZmZlcmVudCBpY29ucyBiYXNlZCBvbiBGb3Vyc3F1YXJlIGNhdGVnb3J5XG5cdFx0XHR2YXIgaWNvbjtcblx0XHRcdHN3aXRjaCAobG9jLmNhdGVnb3J5KSB7XG5cdFx0XHRcdGNhc2UgJ0JlYWNoJzpcblx0XHRcdFx0XHRpY29uID0gXCJodHRwOi8vbWFwcy5nb29nbGUuY29tL21hcGZpbGVzL21zL2ljb25zL2JsdWUtZG90LnBuZ1wiO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlICdSZXNvcnQnOlxuXHRcdFx0XHRcdGljb24gPSBcImh0dHA6Ly9tYXBzLmdvb2dsZS5jb20vbWFwZmlsZXMvbXMvaWNvbnMvZ3JlZW4tZG90LnBuZ1wiO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlICdDYWbDqSc6XG5cdFx0XHRcdFx0aWNvbiA9IFwiaHR0cDovL21hcHMuZ29vZ2xlLmNvbS9tYXBmaWxlcy9tcy9pY29ucy95ZWxsb3ctZG90LnBuZ1wiO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRkZWZhdWx0OlxuXHRcdFx0XHRcdGljb24gPSBcImh0dHA6Ly9tYXBzLmdvb2dsZS5jb20vbWFwZmlsZXMvbXMvaWNvbnMvcmVkLWRvdC5wbmdcIjtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdH1cblx0XHRcdHZhciBtYXJrZXIgPSBuZXcgZ29vZ2xlLm1hcHMuTWFya2VyKHtcblx0XHRcdFx0aWNvbjogaWNvbixcblx0XHRcdCAgICBwb3NpdGlvbjogbXlMYXRsbmcsXG5cdFx0XHQgICAgdGl0bGU6XCJIZWxsbyBXb3JsZCFcIlxuXHRcdFx0fSk7XG5cblx0XHRcdC8vb3BlbiBpbmZvV2luZG93IG9uY2xpY2tcblx0XHRcdG1hcmtlci5hZGRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbigpe1xuXHRcdFx0XHRtYXJrZXIuc2V0QW5pbWF0aW9uKGdvb2dsZS5tYXBzLkFuaW1hdGlvbi5CT1VOQ0UpO1xuXHRcdFx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG5cdFx0XHQgICAgICAgIG1hcmtlci5zZXRBbmltYXRpb24obnVsbCk7XG5cdFx0XHQgICAgfSwxNDAwKTtcblx0XHRcdFx0aW5mb3dpbmRvdy5vcGVuKGdvb2dsZU1hcC5tYXAsIG1hcmtlcik7XG5cdFx0XHR9KTtcblx0XHRcdG1hcmtlci5zZXRNYXAoZ29vZ2xlTWFwLm1hcCk7XG5cdFx0XHRnb29nbGVNYXAubWFya2Vyc1tsb2MuaWRdID0gbWFya2VyO1xuXHRcdFx0Z29vZ2xlTWFwLmluZm93aW5kb3dzW2xvYy5pZF0gPSBpbmZvd2luZG93O1xuXHRcdFx0JChkb2N1bWVudCkudHJpZ2dlcihcIm1hcmtlcmxvYWRcIitsb2MuaWQpO1xuXHRcdH1cblx0fSxcblxuXHQvKiogQG1ldGhvZCBzaG93cyBhbGwgbG9jYXRpb25zIGxpc3RlZCBvbiBtYXBcblx0ICogIEBwYXJhbSB7YXJyYXl9IGlkcyAtIGxpc3Qgb2YgbG9jYXRpb24gaWRzIHRvIHNob3dcblx0ICovXG5cdHNldExvY2F0aW9uczogZnVuY3Rpb24oaWRzKXtcblx0XHRfLmVhY2goZ29vZ2xlTWFwLm1hcmtlcnMsZnVuY3Rpb24obWFya2VyKXtcblx0XHRcdG1hcmtlci5zZXRNYXAobnVsbCk7XG5cdFx0fSk7XG5cdFx0aWRzLmZvckVhY2goZnVuY3Rpb24oaSl7XG5cdFx0XHRnb29nbGVNYXAubWFya2Vyc1tpXS5zZXRNYXAoZ29vZ2xlTWFwLm1hcCk7XG5cdFx0fSk7XG5cdH0sXG5cblx0LyoqIEBtZXRob2Qgc2hvd3MgYWxsIGxvY2F0aW9ucyBvbiBtYXBcblx0ICovXG5cdHNob3dBbGxNYXJrZXJzOiBmdW5jdGlvbigpe1xuXHRcdF8uZWFjaChnb29nbGVNYXAubWFya2VycyxmdW5jdGlvbihtYXJrZXIpe1xuXHRcdFx0bWFya2VyLnNldE1hcChnb29nbGVNYXAubWFwKTtcblx0XHR9KTtcblx0fSxcblxuXHQvKiogQG1ldGhvZCBhcHBlbmRzIHBob3RvcyB0byBpbmZvd2luZG93XG5cdCAqXHRAcGFyYW0ge3N0cmluZ30gaWQgLSBJRCBvZiBsb2NhdGlvblxuXHQgKlx0QHBhcmFtIHtvYmplY3R9IHBob3RvcyAtIGZvdXJzcXVhcmUgcGhvdG8gYXJyYXkgLSBpbmNsdWRlcyBuZWNlc3NhcnkgaW5mbyB0byBnZXQgYSBwaWN0dXJlXG5cdCAqL1xuXHRhZGRQaG90b3M6IGZ1bmN0aW9uKGlkLCBwaG90b3Mpe1xuXHRcdGlmKCFnb29nbGVNYXAubWFya2Vyc1tpZF0pey8vd2FpdCBmb3IgbWFya2VyIHRvIGluaXRpYWxpemUgcHJpb3IgdG8gYWRkaW5nIG1hcmtlclxuXHRcdFx0JChkb2N1bWVudCkuYmluZChcIm1hcmtlcmxvYWRcIitpZCxmdW5jdGlvbigpe1xuXHRcdFx0XHRnb29nbGVNYXAuYWRkUGhvdG9zKGlkLHBob3Rvcyk7XG5cdFx0XHR9KTtcblx0XHR9XG5cdFx0ZWxzZSB7XG5cdFx0XHR2YXIgY29udGVudCA9ICQucGFyc2VIVE1MKGdvb2dsZU1hcC5pbmZvd2luZG93c1tpZF0uZ2V0Q29udGVudCgpKTtcblx0XHRcdF8uZWFjaChwaG90b3MuaXRlbXMsIGZ1bmN0aW9uKHBob3RvKXtcblx0XHRcdFx0Ly9jb25zb2xlLmxvZyhwaG90byk7XHRcblx0XHRcdFx0JChjb250ZW50KS5hcHBlbmQoJzxpbWcgc3JjID1cIicrcGhvdG8ucHJlZml4KycyMDB4MTAwJytwaG90by5zdWZmaXgrJ1wiPicpO1xuXHRcdFx0fSk7XG5cdFx0XHRnb29nbGVNYXAuaW5mb3dpbmRvd3NbaWRdLnNldENvbnRlbnQoJChjb250ZW50KS5wcm9wKFwib3V0ZXJIVE1MXCIpKTtcblx0XHR9XG5cdH0sXG5cblx0LyoqIEBtZXRob2QgT3BlbnMgaW5mb3dpbmRvd1xuXHQgKlx0QHBhcmFtIHtzdHJpbmd9IGlkIC0gSUQgb2YgbG9jYXRpb25cblx0ICovXG5cdHNob3dJbmZvOiBmdW5jdGlvbihpZCl7XG5cdFx0Z29vZ2xlLm1hcHMuZXZlbnQudHJpZ2dlcihnb29nbGVNYXAubWFya2Vyc1tpZF0sICdjbGljaycpO1xuXHR9XG59O1xuXG4kKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbiAoKSB7XG5cdC8vdGltZW91dCBpZiBtYXAgZG9lc24ndCBsb2FkLlxuXHRnb29nbGVNYXAuZ21hcFJlcXVlc3RUaW1lb3V0ID0gc2V0VGltZW91dChmdW5jdGlvbigpe1xuICAgICAgICAkKCcjbWFwJykudGV4dChcIkZhaWxlZCB0byBnZXQgR29vZ2xlIE1hcC4gUGxlYXNlIGNoZWNrIHlvdXIgY29ubmVjdGlvbi5cIik7XG4gICAgfSw4MDAwKTtcbn0pOyIsIi8vIFVzZWQgdG8gdG9nZ2xlIG9mZmNhbnZhcyBzaWRlYmFyXG4kKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbiAoKSB7XG4gICQoJ1tkYXRhLXRvZ2dsZT1cIm9mZmNhbnZhc1wiXScpLmNsaWNrKGZ1bmN0aW9uICgpIHtcbiAgICAkKCcucm93LW9mZmNhbnZhcycpLnRvZ2dsZUNsYXNzKCdhY3RpdmUnKVxuICB9KTtcbn0pOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
